# ADR-0001: Next.js 버전 업그레이드

## 📣 상태

채택됨 (Accepted) - 2025-10-28

## 📋 상황

Next.js 16이 출시됨에 따라, Next.js 15.6버전과 비교하여,

1.현재 사용하고 있던 React 19.2를 안정화 할 수 있음.

2.react compiler 1.0를 실험적 기능이 아닌 정식 기능으로 채택할 수 있음.

## ✋ 나의 생각

- 복잡하다 복잡하다 하니까 이제 좀 줄여준 느낌?
- 과거의 실험적인 것을 이제 없애고 정식으로 채택된 것들이 많음
  - AMP 지원 삭제
  - next 명령어들 정리
  - config 파일 정리
  - 옛버전의 명령어 일부 삭제
  - 대대적인 성능 개선과 구조 개편

- 성능 개선만 하면 좀 섭섭하니까 Cache Components 슬쩍 추가됨

## 🔨 결정

Next.js를 15.6에서 16으로 업그레이드한다.

## 📊 영향

### 📈 긍정적 영향

- 빌드 시간 단축
- React 19.2 최적화로 새로운 기능 사용 가능
- React Compiler 정식 지원으로 성능 최적화

### 📉 부정적 영향 / 마이그레이션 필요사항

- 의존성 패키지 업데이트 필요

## 📝 고려한 대안

1. **현재 버전 유지**: 단기적으로는 안정적이지만 최신 기술 적용해보는 실험실이기 때문에 기술 호환 실험을 위한 선택
2. **점진적 업그레이드**: 중간 버전을 거쳐 업그레이드하는 방법도 고려했으나, 마이그레이션 비용이 중복됨

## 📚 Next.js 16 변경점

### 1️⃣ 개요

- 성능 최적화와 새로운 아키텍처 도입에 초점을 맞춘 업데이트
- Rust 기반 번들러 Turbopack을 기본 빌드 도구로 채택
- 부분 사전 렌더링(PPR) 아이디어를 발전시킨 Cache Components라는 새 캐싱 모델을 도입
- 라우팅 시스템을 전면 개편하여 페이지 전환을 최적화
- Next.js Devtools와 향상된 로그 출력(개발자 경험 개선)
- 과거의 산물(AMP 지원, next/legacy/image)이 제거됨

### 2️⃣ 주요 변경사항

| 카테고리             | Next.js 15                                                                                                                                                                                | Next.js 16                                                                                                                                                                                                                                                                                                                                                       |
| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 빌드 시스템          | - Webpack 기반의 번들러 채택.<br>- Vercel에서만 최적화 잘되는 느낌이라 Next.js 쓸꺼면 Vercel 배포해라 느낌.외부 패키지 번들링도 제공했긴함.<br>- 정적페이지 빌드 시간 단축 및 캐시 재사용 | - Turbopack 기반의 번들러 채택. 빌드, HWR 최적화 및 빌드 시간 단축.<br>- 파일 시스템 캐싱이라는 실험적 기능 도입<br>- 커스텀 빌드 파이프라인 삽입 할 수 있는 API 제공                                                                                                                                                                                            |
| 라우팅 및 네비게이션 | - App Router 안정화<br>- form 개선                                                                                                                                                        | - Prefetch 로직 개편<br>- 동일 레이아웃을 공유하면 레이아웃 데이터를 한번만 가져오도록 중복 제거. <br>- 증분 프리패칭으로 캐시 되지 않은 부분만 선별적으로 미리 불러오는 방식으로 개편(단 prefetch 요청은 늘었음. 그러나 총 전송량은 크게 감소)<br>- 모든 병렬 라우트 그룹에는 이제 default.js 파일이 필수로 요구(명시적으로 변경)<br>- middleware.js → proxy.js |
| React 관련           | - 자기들 말로는 React 19.1 최적화 했다는데 App Router 에서 알 수 없는 오류 좀 떴음(use 같은 Hook 규칙 예외인 것들에 대하여)                                                               | - React 19.2 최적화(과연?)으로 인해 신규 기능 다수 들어옴(View Transitions, useEffectEvent 훅, <Activity> 컴포넌트)<br>- React Compiler 지원이 정식으로 승격                                                                                                                                                                                                     |
| 개발자 경험 및 도구  | - Hydration 에러 메시지를 개선<br>- ESLint 9 지원                                                                                                                                         | - Next.js Devtools (MCP) 초읽기<br>- 로깅 및 터미널 출력 향상(확실히 좋아짐. 어떤 부분이 문제인지 쉽게 파악할 수 있음) <br>- 프로젝트 세팅 간소화                                                                                                                                                                                                                |

## 📚 참고자료

- [Next.js 16 출시](https://nextjs.org/blog/next-16)
